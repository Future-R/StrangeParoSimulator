
import { GameEvent } from '../../types';

export const NARRATIVE_EVENTS: GameEvent[] = [
  // ===========================
  // 无选项日常/怪文书事件 (Narrative)
  // ===========================
  {
    id: 'narrative_morning_greeting',
    权重: 40,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役"',
    正文: '清晨，{当前角色.名称}在校门口遇到了你。她露出了极其灿烂的笑容，仿佛整个世界都亮了起来。“{训练员.称呼}！早上好！” 周围的空气似乎都变得甜蜜了。',
    操作指令: '属性变更 心情 5; 属性变更 爱欲 1; 关系变更 友情 2'
  },
  {
    id: 'narrative_shared_drink',
    权重: 40,
    可触发次数: -1,
    标签组: ['暧昧'],
    触发条件: '当前角色.标签组 存在 "在役" && 随机(1~100) > 60 && 当前角色.关系.玩家.爱情 > 15',
    正文: '休息时，{当前角色.名称}极其自然地拿起了你的水壶喝了一口，然后才装作刚发现的样子：“哎呀，拿错了…不过没关系吧？” 她耳根有点红。',
    操作指令: '属性变更 爱欲 3; 关系变更 爱情 2'
  },
  {
    id: 'narrative_laundry_mystery',
    权重: 30,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.标签组 存在 "沉重"',
    正文: '你在寻找昨天换下来的衬衫，最后竟然在{当前角色.名称}的运动包一角发现了它。被发现时，她慌乱地解释说是洗衣服时混进去了…但为什么已经洗干净并叠得整整齐齐的呢？',
    操作指令: '属性变更 心情 -2; 属性变更 爱欲 5; 关系变更 爱情 5'
  },
  {
    id: 'narrative_sleep_mumble',
    权重: 35,
    可触发次数: -1,
    标签组: ['暧昧'],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.关系.玩家.爱情 > 20',
    正文: '{当前角色.名称}在活动室的沙发上睡着了。你经过时，听到她模糊的梦话：“{训练员.称呼}…嘿嘿…那里不可以…” 你决定假装什么都没听见，但心跳不由得加快了。',
    操作指令: '属性变更 爱欲 2; 关系变更 爱情 1'
  },
  {
    id: 'narrative_rainy_day',
    权重: 30,
    可触发次数: -1,
    标签组: ['暧昧', '日常'],
    触发条件: '!(当前角色.标签组 存在 "厌男" && 训练员.性别 == "男")',
    正文: '突降暴雨。你和{当前角色.名称}两人只带了一把伞，只好共用。她的肩膀紧紧贴着你，你能感受到透过湿润布料传来的体温。她似乎并不讨厌这场雨。',
    操作指令: '属性变更 心情 3; 属性变更 爱欲 2; 关系变更 爱情 3'
  },
  {
    id: 'narrative_trash_sorting',
    权重: 25,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.标签组 存在 "沉重"',
    正文: '你发现办公室垃圾桶里的空咖啡罐不见了。转身看到{当前角色.名称}正在仔细地将它们作为收藏品陈列在她的储物柜深处。“这是{训练员.称呼}努力过的证明…”她喃喃自语。',
    操作指令: '属性变更 爱欲 10; 关系变更 爱情 10'
  },
  {
    id: 'narrative_late_work',
    权重: 45,
    可触发次数: -1,
    标签组: ['工作'],
    触发条件: '当前角色.标签组 存在 "训练员" && 当前角色.属性.精力 > 10 && 当前角色.属性.体力 > 10',
    预操作指令: '设置变量 角色 随机角色 = 获取随机队友()',
    正文: '为了制定新的训练计划，你不得不加班到深夜。窗外的特雷森学园静悄悄的。虽然辛苦，但为了{随机角色.名称}的笑容，一切都是值得的。',
    操作指令: '属性变更 学识 1; 属性变更 体力 -10; 属性变更 精力 -10'
  },
  {
    id: 'narrative_good_condition',
    权重: 40,
    可触发次数: -1,
    标签组: ['训练'],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.属性.心情 > 70',
    正文: '{当前角色.名称}今天状态绝佳！跑步姿势轻盈得像一阵风。她回头看向你，比了一个V字手势。',
    操作指令: '属性变更 速度 5; 属性变更 耐力 5; 属性变更 力量 5; 属性变更 毅力 5; 属性变更 智慧 5; 关系变更 友情 2'
  },
  {
    id: 'narrative_bad_dream',
    权重: 20,
    可触发次数: -1,
    标签组: ['心情下降'],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.关系.玩家.友情 > 50',
    正文: '{当前角色.名称}顶着黑眼圈来到了训练场。似乎是做了一个你辞职离开的噩梦，即使你再三保证不会离开，她还是紧紧抓着你的衣角不放了一整天。',
    操作指令: '属性变更 精力 -15; 属性变更 心情 -10; 关系变更 爱情 3'
  },
  {
    id: 'narrative_diary',
    权重: 25,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "沉重" && 当前角色.标签组 存在 "在役"',
    正文: '你无意中看到{当前角色.名称}正在写日记。每一页上都密密麻麻写满了关于你的观察记录：“8:03 喝了咖啡”、“10:15 打了个喷嚏”、“12:30 和绿色恶魔说了两句话（记仇）”…',
    操作指令: '属性变更 爱欲 5; 关系变更 爱情 5'
  },
  {
    id: 'narrative_plushie',
    权重: 20,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.关系.玩家.爱情 > 10',
    正文: '{当前角色.名称}包上挂着一个新的玩偶，仔细一看，那个玩偶的穿着打扮和你一模一样。',
    操作指令: '属性变更 爱欲 5; 关系变更 爱情 3'
  },
  
  // --- 联动/梗事件 (新增) ---
  {
    id: 'gambler_learn',
    权重: 1,
    可触发次数: 1,
    标签组: [],
    触发条件: '当前角色.模板ID != "特别周" && 当前角色.标签组 不存在 "赌狗"', 
    正文: '{当前角色.名称}从特别周那里学会了如何赌博，然后一发不可收拾。',
    操作指令: '获得标签 赌狗'
  },
  {
    id: 'gambler_win_nature',
    权重: 33,
    可触发次数: -1, // Infinite
    标签组: [],
    触发条件: '当前角色.标签组 存在 "赌狗" && 当前角色.标签组 存在 "配角"',
    正文: '{当前角色.名称}借了很多钱去赌骰子。结果因为全押3点而大赚了一笔。',
    操作指令: '属性变更 财富 3'
  },
  {
    id: 'gambler_bet',
    权重: 15,
    可触发次数: -1,
    标签组: ['赌狗'],
    触发条件: '当前角色.标签组 存在 "赌狗"',
    标题: '绝对回本？',
    预操作指令: '设置变量 运气值 = 随机(1~100); 变量计算 运气值 + 20 若 当前角色.标签组 存在 "幸运"',
    正文: '听说商店街新进了一台号称“绝对回本”的推币机，{当前角色.名称}眼神犀利地坐了下来。\n结果……{运气值 > 80 ? "随着哗啦啦的巨响，硬币塔倒塌了！大丰收！" : "投进去的币像石沉大海一样毫无动静……被骗了。"}',
    分支组: [
      {
        判别式: '变量.运气值 > 80',
        操作指令: '属性变更 财富 1; 属性变更 心情 5',
        注释: '获胜'
      },
      {
        判别式: 'true',
        操作指令: '属性变更 财富 -1; 属性变更 心情 -10',
        注释: '失败'
      }
    ]
  },
  {
    id: 'fake_fortune_telling',
    权重: 10,
    可触发次数: -1,
    标签组: ['日常'],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.模板ID != "待兼福来" && 当前角色.模板ID != "小林历奇"',
    预操作指令: '设置变量 角色 随机角色 = 获取随机队友()',
    正文: '{当前角色.名称}自称找了待兼福来占卜，说本周的幸运行为是与{随机角色.名称}十指相握。',
    操作指令: '关系变更(爱情, 当前角色, 随机角色, 7)'
  },
  {
    id: 'trainer_sees_rice',
    权重: 40,
    可触发次数: 1,
    标签组: ['日常'],
    触发条件: '当前角色.标签组 存在 "训练员"',
    正文: '偶然间，看到米浴鬼鬼祟祟背着一个圆圆的东西走过。',
    操作指令: '属性变更 财富 1'
  },
  {
    id: 'golshi_past_peak',
    权重: 30,
    可触发次数: 1,
    标签组: ['日常', '心情下降'],
    触发条件: '当前角色.标签组 存在 "在役" && 当前年 == 3 && 当前角色.模板ID != "黄金船"',
    正文: '黄金船跑来和{当前角色.名称}说：“你已经过巅峰期了。”',
    操作指令: '属性变更 心情 -10'
  },
  {
    id: 'ninja_slayer_meme',
    权重: 3,
    可触发次数: 1,
    标签组: ['梗'],
    触发条件: '当前角色.模板ID != "黄金船"',
    正文: '经过一个戴着墨镜的马娘身边时，她忽然开口道：“Domo，{当前角色.名称}=san，忍者杀手Desu。”',
  },
  {
    id: 'jojo_meme',
    权重: 3,
    可触发次数: 1,
    标签组: ['梗'],
    触发条件: '当前角色.模板ID != "黄金船"',
    正文: '经过一个戴着墨镜的马娘身边时，她忽然开口道：“哦？居然不逃跑反而向我走来吗？”',
  },
  {
    id: 'tazuna_date',
    权重: 50,
    可触发次数: 5,
    标签组: ['日常', '约会'],
    触发条件: '当前角色.标签组 存在 "训练员"',
    标题: '出行邀请',
    正文: '“{当前角色.名称}，休息日了要一起出门走走吗。”骏川手纲突然出现在你的面前对你发出邀请。',
    选项组: [
      { 显示文本: '去吃饭', 操作指令: '属性变更 体力 20; 属性变更 心情 10; 关系变更(友情, 当前角色, 骏川手纲, 5)' },
      { 显示文本: '去购物', 操作指令: '属性变更 心情 15; 属性变更 财富 -1; 关系变更(友情, 当前角色, 骏川手纲, 5)' },
      { 显示文本: '去看电影', 操作指令: '属性变更 学识 1; 属性变更 心情 10; 关系变更(友情, 当前角色, 骏川手纲, 5)' },
      { 显示文本: '还是算了', 操作指令: '属性变更 心情 -5' }
    ]
  },
  {
    id: 'tazuna_secret_reveal',
    权重: 40,
    可触发次数: 1,
    标签组: ['日常'],
    // 触发条件：训练员触发 && 与骏川手纲友情值 >= 25
    触发条件: '当前角色.标签组 存在 "训练员" && 关系.骏川手纲.友情 >= 25',
    正文: '无意中撞见摘下帽子的骏川小姐。\n“骏川小姐，你脑袋上那是……”\n“啊哈哈……我睡相一向很差啦……”\n“那你屁股后面这个……肛毛……”\n“其实我是马娘。”',
    操作指令: '关系变更(友情, 当前角色, 骏川手纲, 10)'
  },

  // --- 怪文书/情感事件 (有选项) ---
  {
    id: 'gw_midnight_call',
    权重: 30,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.属性.心情 > 50 && 当前角色.关系.玩家.友情 > 70',
    标题: '深夜来电',
    正文: '凌晨两点，训练员的手机突然响了。电话那头传来了{当前角色.名称}的声音：“{训练员.称呼}…你睡了吗？我睡不着…能不能…听我说话？”',
    选项组: [
      { 显示文本: '陪她聊通宵', 操作指令: '属性变更 爱欲 5; 属性变更 精力 -20; 属性变更 心情 5; 关系变更 爱情 5' },
      { 显示文本: '催她快去睡觉', 操作指令: '属性变更 体力 15; 属性变更 心情 -5' }
    ]
  },
  {
    id: 'gw_silent_gaze',
    权重: 35,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.关系.玩家.爱情 > 25',
    标题: '无言的视线',
    正文: '在指导其他马娘动作时，你总感觉背后有一道灼热的视线。回头一看，{当前角色.名称}正站在角落里，眼神晦暗不明地盯着这边。',
    选项组: [
      { 显示文本: '向她微笑', 操作指令: '属性变更 魅力 1; 属性变更 心情 2; 关系变更 友情 2' },
      { 显示文本: '假装没看见', 操作指令: '属性变更 心情 -5; 获得标签 沉重; 属性变更 爱欲 5; 关系变更 爱情 3' }
    ]
  },
  {
    id: 'gw_heavy_bento',
    权重: 25,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役" && 当前角色.标签组 存在 "沉重" ',
    标题: '便当的重量',
    正文: '“这是我亲手做的便当，{训练员.称呼}一定会全部吃完的…对吧？”{当前角色.名称}微笑着递过来一个巨大的饭盒，里面的配菜摆成了“LOVE”的形状。份量大概是正常人的三倍。',
    选项组: [
      { 显示文本: '拼死吃完', 操作指令: '属性变更 体质 1; 属性变更 速度 -2; 属性变更 心情 5; 属性变更 体力 10; 关系变更 爱情 5' },
      { 显示文本: '分给同事吃', 操作指令: '属性变更 魅力 -2; 属性变更 心情 -10; 关系变更 爱情 -5' }
    ]
  },
  {
    id: 'gw_rumors',
    权重: 20,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "在役"',
    标题: '学园传闻',
    正文: '最近学园里的布告栏上出现了一些奇怪的匿名贴：“某位训练员和专任马娘在活动室待到很晚…” 大家都在窃窃私语。',
    选项组: [
      { 显示文本: '身正不怕影子斜', 操作指令: '属性变更 毅力 5' },
      { 显示文本: '暗自窃喜', 操作指令: '属性变更 心情 5; 属性变更 爱欲 2; 关系变更 爱情 2' }
    ]
  },
  {
    id: 'gw_exclusive_right',
    权重: 15,
    可触发次数: -1,
    标签组: [],
    触发条件: '当前角色.标签组 存在 "沉重" && 当前角色.标签组 不存在 "训练员"',
    标题: '独占欲',
    正文: '{当前角色.名称}突然紧紧抓住了你的衣袖，力道大得惊人。“{训练员.称呼}…这个周末，只属于我一个人，好吗？哪里都不许去…”',
    选项组: [
      { 显示文本: '答应她', 操作指令: '属性变更 心情 10; 属性变更 精力 -10; 属性变更 爱欲 10; 关系变更 爱情 10' },
      { 显示文本: '婉拒', 操作指令: '属性变更 心情 -20; 属性变更 爱欲 5' }
    ]
  }
];
